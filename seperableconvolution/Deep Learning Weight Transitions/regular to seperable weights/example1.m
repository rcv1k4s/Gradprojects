% Example 1 from the paper 
% Low-Rank Matrix Approximation in the Infinity Norm, Nicolas Gillis and 
% Yaroslav Shitov, 2017. 
clc;
clear;
fid = fopen('origpar.txt','r');
A = fscanf(fid,'%f');
fclose(fid);
B = zeros(288,7,7);
C = zeros(288,7,7);
k= zeros(288,7,7)
i=1;
m=1;
while i<289
    j=1;
    while j<8
        k=1;
        while k<8
            B(i,j,k)=A(m);
            k=k+1;
            m=m+1;
        end
        j=j+1;
    end
    i=i+1;
end
i=1
while i<289
    M = zeros(7,7);  
    M=[B(i,:,1) ; B(i,:,2) ; B(i,:,3) ; B(i,:,4) ; B(i,:,4) ; B(i,:,6) ; B(i,:,7) ];
    % %M = [-0.00378918 -0.00958649 -0.01807493 -0.02050975 -0.01436122 -0.00495939    0.02351925 ; -0.00958649 -0.01601228 -0.02521573  0.00726614  0.01938289 -0.01517531   0.02557473 ; -0.01807493 -0.02521573 -0.03968639  0.04402969 -0.00025851 -0.02904222   0.04422813 ; -0.02050975  0.00726614  0.04402969  0.11811747 -0.05986078 -0.02047845   0.05090658 ; -0.01436122  0.01938289 -0.00025851 -0.05986078 -0.17128828  0.01595623   0.02959463 ; -0.00495939 -0.01517531 -0.02904222 -0.02047845  0.01595623  0.08594619   0.01919603 ; 0.02351925  0.02557473  0.04422813  0.05090658  0.02959463  0.01919603  -0.00705284 ]
    [u,v,e,t] = norminfLRAbcd(M); 
    C(i,:,:)=u*v;
    K = M-C(i,:,:)
    i=i+1;
end
fid = fopen('sepwts.txt','w');
A = fprintf(fid,'%f ',C);
fclose(fid);
